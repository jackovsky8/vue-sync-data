!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).syncQuery={})}(this,function(e){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){"undefined"!=typeof console&&(console.warn("[vue-sync-query] "+e),t&&console.warn(t.stack))}var o,u={data:function(){return{syncQuery:{query:{}}}},created:function(){this._syncQuery=new t(this)}};var h=function e(t,n,r){var i=this;s(this,e),a(this,"_object",void 0),a(this,"_expression",void 0),a(this,"_parent",void 0),a(this,"_syncQuery",void 0),a(this,"watchFn",function(e){null==e||isEmpty(e)?i._parent._vm.$delete(i._syncQuery.query,i._object.name,e):i._parent._vm.$set(i._syncQuery.query,i._object.name,e)}),this._object=t,this._expression=n,this._parent=r,this._syncQuery=r._syncQuery},y=function e(t){var n=this;s(this,e),a(this,"parent",void 0),a(this,"watchFn",function(e,t){n.parent.readQuery()}),this.parent=t},l=function e(t){var n=this;s(this,e),a(this,"parent",void 0),a(this,"watchFn",function(e,t){n.parent.setQuery()}),this.parent=t},t=function(){function r(e){if(s(this,r),a(this,"_vm",void 0),a(this,"_watchers",void 0),a(this,"_route_watcher",void 0),a(this,"_query_watcher",void 0),a(this,"_query",void 0),a(this,"_syncValue",void 0),a(this,"readQuery",function(){if(this._vm.$route){var e=this._vm.$route.query;if(e&&isObject(e)&&!isEmpty(e))for(var t in this._watchers)if(this._watchers.hasOwnProperty(t)){var n=this._watchers[t];"Object"===n.type.name&&console.log("Objecterl");var r=this._vm.$route.query[n.name];void 0!==r&&set(this._vm,n.expression,r)}}else c("Vue Router is required!")}),a(this,"setQuery",function(){this._vm.$router&&this._vm.$router.push({query:this._syncValue.query})}),e instanceof o){this._vm=e;var t=this._vm.$options;t.syncQuery=t.syncQuery||(t.__syncQuery?{}:null);var n={};t.syncQuery&&isObject(t.syncQuery)&&(c("some Data to Sync given ".concat(e._uid)),n=this._getValidSyncObjects(t.syncQuery)),this._syncValue=e.syncQuery,isEmpty(n)||(this._setWatchers(n),this.readQuery())}else c("You have to give the Vue instance to Sync Query!")}var e,t,n;return e=r,(t=[{key:"_getValidSyncObjects",value:function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];r.name&&isString(r.name)?r.type&&isObject(r.type)&&r.type.name&&("String"===r.type.name||"Number"===r.type.name||"Boolean"===r.type.name||"Array"===r.type.name)?!r.nullable||isBoolean(r.nullable)?r.validate&&"function"!=typeof r.validate?c("The value 'validate' of the syncQuery Object has to be a function!"):t[n]=r:c("The value 'nullable' of the syncQuery Object has to be a Boolean!"):c("The value 'type' of the syncQuery Object has to be a String | Number | Boolean | Array!"):c("The value 'name' of the syncQuery Object has to be a String!")}return t}},{key:"_setWatchers",value:function(r){if(this._vm){this._unsetWatchers();var e=Object.keys(r),i=this;e.forEach(function(e){var t=r[e],n=new h(t,e,i);i._watchers.push({unwatchFn:null,expression:e,name:t.name,type:t.type,nullable:void 0===t.nullable||t.nullable,validate:"function"==typeof t.validate?t.validate:null,watchFn:n}),i._watchers[i._watchers.length-1].unwatchFn=i._vm.$watch(e,n.watchFn)});var t=new y(this);this._route_watcher={unwatchFn:null,expression:"$route",watchFn:t},this._route_watcher.unwatchFn=this._vm.$watch("$route",t.watchFn,{deep:!0});var n=new l(this);this._query_watcher={unwatchFn:null,expression:"syncQuery.query",watchFn:n},this._query_watcher.unwatchFn=this._vm.$watch("syncQuery.query",n.watchFn,{deep:!0})}}},{key:"_unsetWatchers",value:function(){this._watchers&&isArray(this._watchers)&&this._watchers.forEach(function(e){e.unwatchFn()}),this._watchers=[]}}])&&i(e.prototype,t),n&&i(e,n),r}();a(t,"install",function e(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("production"!==process.env.NODE_ENV&&e.installed&&t===o)c("already installed.");else{var r;e.installed=!0,o=t,n=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(e){a(t,e,n[e])})}return t}({},n),(r=o).prototype.hasOwnProperty("$syncQuery")||Object.defineProperty(r.prototype,"$syncQuery",{get:function(){return this._syncQuery}}),o.mixin(u);var i=o.config.optionMergeStrategies;i.syncQuery=i.props}}),e.default=t,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=vue-sync-query.js.map
